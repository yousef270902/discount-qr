<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>
<style>
body { background: #f8f9fa; font-family: Arial, sans-serif; }
.card { border-radius: 15px; }
.download-btn { margin-left: 5px; }
.qr-cell { width: 130px; }
</style>
</head>

<body>
<div class="container py-4">
    <h2 class="mb-4 text-center">ğŸ› ï¸ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h2>

    <!-- Card Ù„Ø¥Ø¶Ø§ÙØ©/ØªØ­Ø¯ÙŠØ« Ù…Ù†ØªØ¬ -->
    <div class="card p-3 mb-4 shadow-sm">
        <h5>â• Ø¥Ø¶Ø§ÙØ© Ø£Ùˆ ØªØ¹Ø¯ÙŠÙ„ Ù…Ù†ØªØ¬</h5>
        <div class="row g-2 align-items-center">
            <div class="col-md-4">
                <input id="pname" class="form-control" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
            </div>
            <div class="col-md-3">
                <input id="pprice" type="number" class="form-control" placeholder="Ø§Ù„Ø³Ø¹Ø±">
            </div>
            <div class="col-md-3">
                <input id="pid" type="hidden">
                <button class="btn btn-primary w-100" onclick="saveProduct()">ğŸ’¾ Ø­ÙØ¸</button>
            </div>
            <div class="col-md-2">
                <button class="btn btn-warning w-100" onclick="clearForm()">ğŸ§¹ Ù…Ø³Ø­ Ø§Ù„Ø­Ù‚ÙˆÙ„</button>
            </div>
        </div>
    </div>

    <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª -->
    <div class="card p-3 shadow-sm">
        <h5>ğŸ“¦ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª</h5>
        <table class="table table-bordered table-striped align-middle mb-0">
            <thead class="table-dark">
                <tr>
                    <th>Ø§Ù„Ø§Ø³Ù…</th>
                    <th>Ø§Ù„Ø³Ø¹Ø±</th>
                    <th>QR Code</th>
                    <th>ØªÙ†Ø²ÙŠÙ„ QR</th>
                    <th>ØªØ¹Ø¯ÙŠÙ„</th>
                    <th>Ø­Ø°Ù</th>
                </tr>
            </thead>
            <tbody id="productsTable"></tbody>
        </table>
    </div>
</div>

<script>
let APP_DATA = {
  settings: { discount: 25, expire: "2026-01-31" },
  products: {
    1: { name: "Ù…Ù†ØªØ¬ 1", price: 100 },
    2: { name: "Ù…Ù†ØªØ¬ 2", price: 200 },
    3: { name: "Ù…Ù†ØªØ¬ 3", price: 300 }
  }
};

let products = {...APP_DATA.products};

function render() {
    const table = document.getElementById("productsTable");
    table.innerHTML = "";

    for (let id in products) {
        const p = products[id];

        const tr = document.createElement("tr");

        tr.innerHTML = `
            <td>${p.name}</td>
            <td>${p.price} Ø¬Ù†ÙŠÙ‡</td>
            <td class="qr-cell" id="qr${id}"></td>
            <td>
                <button class="btn btn-sm btn-secondary download-btn" onclick="downloadQR(${id})">â¬‡ï¸ ØªÙ†Ø²ÙŠÙ„</button>
            </td>
            <td>
                <button class="btn btn-sm btn-info" onclick="editProduct(${id})">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
            </td>
            <td>
                <button class="btn btn-sm btn-danger" onclick="deleteProduct(${id})">ğŸ—‘ï¸ Ø­Ø°Ù</button>
            </td>
        `;
        table.appendChild(tr);

        new QRCode(document.getElementById("qr"+id), {
            text: "https://yousef270902.github.io/discount-qr/discount.html?product=" + id,
            width: 50,
            height: 50
        });
    }
}

function saveProduct() {
    const name = document.getElementById("pname").value.trim();
    const price = document.getElementById("pprice").value;
    const pid = document.getElementById("pid").value;

    if(!name || !price){ alert("Ø§Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ø³Ø¹Ø±"); return; }

    if(pid){ // ØªØ¹Ø¯ÙŠÙ„
        products[pid] = { name, price };
    } else { // Ø¥Ø¶Ø§ÙØ© Ø¬Ø¯ÙŠØ¯
        const newId = Date.now();
        products[newId] = { name, price };
    }

    clearForm();
    render();
}

function editProduct(id){
    document.getElementById("pname").value = products[id].name;
    document.getElementById("pprice").value = products[id].price;
    document.getElementById("pid").value = id;
}

function deleteProduct(id){
    if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ù†ØªØ¬ØŸ")){
        delete products[id];
        render();
    }
}

function downloadQR(id){
    const qrImg = document.getElementById("qr"+id).querySelector("img");
    if(qrImg){
        const link = document.createElement("a");
        link.href = qrImg.src;
        link.download = products[id].name + "_QR.png";
        link.click();
    }
}

function clearForm(){
    document.getElementById("pname").value = "";
    document.getElementById("pprice").value = "";
    document.getElementById("pid").value = "";
}

render();
</script>
</body>
</html>

